\subsection{Anelastic attenuation model}

Energy losses in the form of anelastic attenuation due to material internal friction plays a major role in wave propagation problems and earthquake ground motion simulation. These attenuation effects are typically represented through the characterization of the quality factor, Q. There have been several studies in which Q is modeled using viscoelastic devices, where the effects of internal friction are represented by springs and dashpots. A recently introduced model, called the BKT model (after authors Bielak, Karaoglu and Taborda), proposed the use of two Maxwell elements (each made of a spring and a dashpot connected in series) in combination with a Voigt element (consisting of a spring and a dashpot connected in parallel). The BKT model showed very good adherence to intended values of constant Q = Qo. The BKT model, however, depended on a set of parameters that needed to be computed a priori for a fixed set of Qo values. The model, as well, was limited to problems under the assumption of frequency independent attenuation. BKT implementation holds for any value of $Qo > 5$, with errors less than 5 percent. In this study we use BKT2 model which combines two Maxwell elements and one Voigt element \citep{Bielak2011}. The model converts the provided Q value to desirable attenuation in the forward simulation. For the Q equation we propose to use the following equation: \\

\begin{equation}
Q_{s}(V) = c + \beta(V)^{\alpha}
\end{equation}

Previous authors used similar forms of this relationship (some references). The relationship is simple and flexible. C serves as floor value for low velocity structures and $\alpha$ and $\beta$ offer different growth rates for increasing values of Vs. Qp depends on Qs and Qk which is dilatational reciprocal quality factor. Since in soil and rock materials the intrinsic attenuation due to shear is generally much greater than that due to dilatation, we ignore Qk. Qp is computed using

\begin{equation}
Q_{p}=(3/4)(V_p/V_{s})^2Q_{s}.
\end{equation}

