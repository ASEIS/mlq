
\section{Introduction}

The advances in ground motion simulation techniques and high performance computational resources, and comprehensive studies of velocity models make regional scale ground motion simulations more accurate and possible for higher frequencies ($fmax < 5 Hz$). Complicated source models and  geological features (i.e., heterogeneous velocity models) introduce a broad variation in parameters for each seismic station. Due to mentioned complexities, for one particular earthquake, based on current knowledge about the domain and seismic behavior of them, different stations can be helpful in variable level in studying ground motion simulation parameters. It is a common practice to consider all stations results and compute a average the parameters as a finial result. However, with the complexity involved in the model and in reality,  all stations for different earthquakes are not contributing the same information at the same level. Therefore, a comprehensive study should be considered to understand whether each station due to its distance and azimuth from source, as well as its site characterization have a potential to provide useful information about the research parameter. In other words, we need to take customized approaches toward each station. Therefore, before comparing the results with observation we need to setup a system to understand what information we can extract from the model and consequently from each station. Application of this idea is possible due to mentioned advances in physics-based ground motion simulation technics, however, due to need for considerable computational resources and significant time for simulations, sensitivity and optimization analyses are barely considered for these solutions. Machine learning technics, specifically artificial neural networks, are very trustable tools to be trained as a complicated nonlinear functions and predict accurate results in a short time, providing enough training data. This idea can have a broad application in seismology and physics-based ground motion simulation.  In this paper, however,  we focus on the application of the proposed method on studying the seismic quality factor (Q factor) parameters for physics-based ground motion simulation. Although customized solution for each seismic station is not a common practice in seismology, however, customized solutions have been studied and discussed in other fields of science. Specifically, personalized medicine research is a hot topic in health care studies \citep{weiss2012machine,jin2009hearttogo,katsios2010individual,hamburg2010path,offit2011personalized}. \\
In this paper we study the application of a customized solution idea in seismic attenuation model parameters. The amplitude of seismic waves decreases as the distance from source increases. In the absence of large deformations (nonlinearities), this is due to: Geometric spreading, intrinsic attenuation, and scattering. Geometric spreading and scattering (due to heterogenous velocity model) are inherently considered in 3D ground motion simulation. Intrinsic attenuation, on the other hand,  happens due to irreversible changes in the crystal defect structures of the medium. These media are called anelastic and the configuration of material particles is to some extended dependent on the history of applied stress \citep{aki2002quantitative}. Intrinsic attenuation or internal friction is studied by means of quality factor (Q) which is inversely related to the strength of the attenuation. In seismology, anelastic damping is studied from different perspective for different application.   From the definition of Q factor (fractional energy loss per cycle) it is concluded that the rate of attenuation increases with frequency. Therefore, Q is considered as frequency depended \citep[e.g., see][ and references therein.]{adams1998seismic, withers2013deterministic, mousavi2014average, sedaghati2015estimation, nazemi2017attenuation}. For high frequency Q factor,  \citet{hauksson2006attenuation} showed that the Qp (anelastic damping related to P-wave) and Qs can be different on a regional scale due to  local impedance contrasts, chemical composition, crack structure, grain boundary movement, crustal fluids, and, to a lesser extent, temperature variations within the brittle seismogenic crust. However, many studies showed that the frequency dependency of Q is significant at higher frequencies $( f > 1 Hz)$. In this paper, we are interested in better constraining the parameters of models used to represent the effects of intrinsic attenuation, that is, the quality factors Qs and Qp, and in particular, the relationships used to correlate Qs with Vs in deterministic ground motion simulation. Given the wavelengths and minimum velocities considered in earthquake simulation in the past, attenuation models have been considered to be frequency independent and the dependence of the Qs-Vs relationships with depth has been ignored. The sensitivity of the ground motion to the relationships used to define the quality factors Qs and Qp based on the shear wave velocity Vs as the primary variable is studied and confirmed. \\
Advances in simulation algorithms and methods, and the increasing capability of parallel applications have made it possible to solve seismic wave propagation problems in large regions with highly heterogeneous media at levels of resolution not thought feasible before. A crucial component of these simulations is the accurate representation of the crustal structure using three-dimensional (3D) material models. This entails the definition of the density, the seismic velocities, and the attenuation properties at arbitrary points over large regions. The accurate solution of the wave propagation problem itself also requires the appropriate representation of the energy losses that occur due to internal friction in geomaterials. These losses are important because their omission may lead to the overestimation of the amplification and duration of seismic waves in regions with high dissipative properties.\\
In physic-based earthquake ground-motion simulation, the attenuation of seismic waves is typically treated by means of viscoelastic models \citep[e.g.,][]{day2001memory, graves2003stability, kaser2007arbitrary, Bielak2011}. These models are made of mechanisms that employ numerical techniques to account for the dissipative and transient characteristics of the ground motion. Internally, the properties of a given attenuation model are set based on the material's quality factor, Q. Community velocity models (CVMs) used in simulations do not generally provide values of Q. Instead, the most common approach is to define the quality factors associated with P- and S-waves, Qp and Qs, based on the values of the seismic velocities Vp and Vs obtained from any particular CVM.\\
The value of Qs, for instance, is usually defined based on rules that depend on the value of Vs. Typical forms of $Qs-Vs$ relationships are (piecewise) linear or polynomial functions \citep[e.g.,][]{brocher2008compressional, brocher2005compressional,olsen2003estimation, graves2008seismic,taborda2013ground}. On the other hand, the value of Qp is usually defined in terms of Qs, and, in some cases, also on the velocity contrast Vp/Vs. Table. ~\ref{tab:QsVstable} shows a collection of different Qs-Vs and Qp-Qs relationships used in simulations and other related studies, including the earthquake or scenario event for which they were employed, and the simulation's minimum shear wave velocity (Vsmin) and maximum frequency (fmax).\\
\input{table_qs}
As it can be seen, there is no consensus on the most appropriate set of relationships between seismic velocities and quality factors. The relationship used by \citet{taborda2013ground} was introduced as an attempt to capture some of the main features of other $Qs-Vs$ rules. 
It is known that the relationships between Qs and Vs, and between Qp and Qs can be depth dependent (see, for instance, \citet{olsen2003estimation}, and the references therein) although Qs remains strongly correlated with Vs.  \citet{hauksson2006attenuation} also show that while Qs and Qp increase rapidly with depth in consistency with the crustal structure, but argue that the ratios between Qs and Qp vary with depth and are different within and outside the major basins in southern California. They obtained values of $Qs/Qp > 1$ for most of the region, but found a few limited areas, mostly outside the major sedimentary basins, where $Qs/Qp < 1$. Jordan and Song (2013) concluded that, in general, $Qs \geq Qp$, with $Qs \approx Qp$ near the surface $(z < 5 km)$ but $Qs > Qp$ at depth; and indicated that Qs seems to be in better agreement with the rule $Qs = 50Vs$ at depth but not near the surface, where Qs is not linearly related to Vs. However, most of the simulations done recently (as seen in Table.~\ref{tab:QsVstable}) correspond to numerical models with maximum frequencies, $fmax \leq 1-2 Hz$, and minimum shear wave velocities, $Vsmin \geq 400 m/s$, where one can still assume Q to be frequency independent. Moving forward, it is essential to gather information that allow us to build a consensus about the appropriate choice of Q in simulations. Ideally, this should be done with a rigorous inversion process. This, however, may take a significant amount of time and resources due to the complexity of the problem. \\
Hence fore, In this study we define a Vs dependent quality factor and through using machine learning and optimization process we propose a new approach to study the accurate parameters for physics based ground motion simulation. The method represent significant improvement in narrowing and customizing the search domain and it can be used for more earthquakes, higher frequencies, and different frequency bands. \\ 
In summary, we use genetic algorithm (GA) as an optimization tool to match the synthetic and observation data. However, before comparing with observation and extracting relevant data, for each station we test the model with a known (however, very close to the mean of observation) attenuation parameters. Based on the test scenarios, we understand which range of shear wave velocity of the station has a potential to provide accurate results. Based on the mentioned test, we extract relevant data from the optimization process results.  We test the proposed method on $Mw~5.4$ 2008 Chino Hills earthquake with minimum shear wave velocity of 350 m/s and maximum frequency of 1 Hz. Since the forward simulation on a regional scale requires considerable computational resources and time, conducting this study with actual simulator is practically impossible. Therefore, we generate a pseudo-simulators using neural networks where it can generate the signal parameters with acceptable accuracies in fraction of seconds on one processor instead of using tens of computational nodes to compute them. Our study shows in addition of using peak ground velocity, response spectra, peak ground acceleration, and area under the signal envelop can improve the optimization process functionality and narrow the solution search domain.  It is worth mentioning that the  method is used only for one earthquake in Los Angles basin, using more earthquakes will definitely improve and refine the results, however, the method presented here is a good guideline to plan for numerous earthquake with higher frequency studies. 

















